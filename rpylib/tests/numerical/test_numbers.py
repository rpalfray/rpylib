"""Testing the number theory functions"""

from rpylib.numerical.numbers import a_n, upper_bound_a_n


def test_a_n():
    # values are given in https://oeis.org/A006218/b006218.txt
    res = [a_n(n) for n in range(1_000 + 1)]
    expected = [
        0,
        1,
        3,
        5,
        8,
        10,
        14,
        16,
        20,
        23,
        27,
        29,
        35,
        37,
        41,
        45,
        50,
        52,
        58,
        60,
        66,
        70,
        74,
        76,
        84,
        87,
        91,
        95,
        101,
        103,
        111,
        113,
        119,
        123,
        127,
        131,
        140,
        142,
        146,
        150,
        158,
        160,
        168,
        170,
        176,
        182,
        186,
        188,
        198,
        201,
        207,
        211,
        217,
        219,
        227,
        231,
        239,
        243,
        247,
        249,
        261,
        263,
        267,
        273,
        280,
        284,
        292,
        294,
        300,
        304,
        312,
        314,
        326,
        328,
        332,
        338,
        344,
        348,
        356,
        358,
        368,
        373,
        377,
        379,
        391,
        395,
        399,
        403,
        411,
        413,
        425,
        429,
        435,
        439,
        443,
        447,
        459,
        461,
        467,
        473,
        482,
        484,
        492,
        494,
        502,
        510,
        514,
        516,
        528,
        530,
        538,
        542,
        552,
        554,
        562,
        566,
        572,
        578,
        582,
        586,
        602,
        605,
        609,
        613,
        619,
        623,
        635,
        637,
        645,
        649,
        657,
        659,
        671,
        675,
        679,
        687,
        695,
        697,
        705,
        707,
        719,
        723,
        727,
        731,
        746,
        750,
        754,
        760,
        766,
        768,
        780,
        782,
        790,
        796,
        804,
        808,
        820,
        822,
        826,
        830,
        842,
        846,
        856,
        858,
        864,
        872,
        876,
        878,
        894,
        897,
        905,
        911,
        917,
        919,
        927,
        933,
        943,
        947,
        951,
        953,
        971,
        973,
        981,
        985,
        993,
        997,
        1005,
        1009,
        1015,
        1023,
        1031,
        1033,
        1047,
        1049,
        1053,
        1061,
        1070,
        1072,
        1084,
        1086,
        1098,
        1102,
        1106,
        1110,
        1122,
        1126,
        1130,
        1136,
        1146,
        1150,
        1166,
        1168,
        1174,
        1178,
        1182,
        1186,
        1202,
        1206,
        1210,
        1214,
        1226,
        1230,
        1238,
        1240,
        1252,
        1261,
        1265,
        1267,
        1279,
        1281,
        1289,
        1297,
        1305,
        1307,
        1319,
        1323,
        1329,
        1333,
        1341,
        1343,
        1363,
        1365,
        1371,
        1377,
        1383,
        1389,
        1397,
        1401,
        1409,
        1413,
        1421,
        1423,
        1441,
        1445,
        1449,
        1457,
        1466,
        1468,
        1476,
        1480,
        1492,
        1498,
        1502,
        1504,
        1520,
        1524,
        1532,
        1536,
        1542,
        1544,
        1560,
        1562,
        1572,
        1580,
        1584,
        1590,
        1602,
        1604,
        1608,
        1614,
        1630,
        1632,
        1640,
        1642,
        1648,
        1656,
        1664,
        1668,
        1686,
        1689,
        1697,
        1701,
        1707,
        1709,
        1721,
        1725,
        1733,
        1741,
        1745,
        1749,
        1767,
        1771,
        1775,
        1779,
        1789,
        1793,
        1805,
        1807,
        1819,
        1823,
        1831,
        1833,
        1849,
        1851,
        1855,
        1867,
        1873,
        1875,
        1883,
        1887,
        1901,
        1905,
        1913,
        1917,
        1932,
        1938,
        1942,
        1946,
        1954,
        1958,
        1974,
        1976,
        1982,
        1988,
        1992,
        1996,
        2016,
        2018,
        2024,
        2028,
        2040,
        2044,
        2056,
        2060,
        2068,
        2076,
        2080,
        2082,
        2094,
        2096,
        2108,
        2116,
        2128,
        2130,
        2138,
        2142,
        2148,
        2156,
        2160,
        2162,
        2186,
        2189,
        2193,
        2199,
        2211,
        2215,
        2223,
        2225,
        2235,
        2241,
        2249,
        2253,
        2265,
        2267,
        2275,
        2283,
        2291,
        2295,
        2311,
        2313,
        2325,
        2329,
        2333,
        2335,
        2351,
        2359,
        2363,
        2369,
        2375,
        2377,
        2393,
        2397,
        2409,
        2413,
        2417,
        2421,
        2439,
        2441,
        2445,
        2453,
        2468,
        2470,
        2478,
        2482,
        2488,
        2498,
        2506,
        2510,
        2526,
        2528,
        2536,
        2540,
        2546,
        2550,
        2562,
        2566,
        2578,
        2582,
        2590,
        2592,
        2616,
        2618,
        2622,
        2628,
        2636,
        2642,
        2650,
        2654,
        2660,
        2668,
        2676,
        2678,
        2698,
        2700,
        2708,
        2716,
        2722,
        2726,
        2734,
        2736,
        2752,
        2761,
        2769,
        2771,
        2783,
        2787,
        2791,
        2795,
        2809,
        2811,
        2829,
        2833,
        2839,
        2843,
        2847,
        2855,
        2871,
        2873,
        2877,
        2885,
        2897,
        2899,
        2915,
        2917,
        2927,
        2935,
        2939,
        2941,
        2959,
        2963,
        2971,
        2975,
        2983,
        2987,
        2995,
        3001,
        3013,
        3019,
        3023,
        3025,
        3049,
        3053,
        3057,
        3065,
        3074,
        3078,
        3090,
        3092,
        3100,
        3104,
        3116,
        3118,
        3130,
        3134,
        3142,
        3154,
        3164,
        3168,
        3176,
        3178,
        3190,
        3194,
        3198,
        3200,
        3224,
        3228,
        3236,
        3242,
        3248,
        3250,
        3266,
        3270,
        3280,
        3288,
        3292,
        3296,
        3308,
        3312,
        3320,
        3324,
        3340,
        3342,
        3354,
        3356,
        3362,
        3374,
        3378,
        3382,
        3402,
        3405,
        3413,
        3419,
        3431,
        3435,
        3443,
        3447,
        3455,
        3459,
        3463,
        3469,
        3493,
        3495,
        3499,
        3503,
        3515,
        3519,
        3535,
        3537,
        3543,
        3549,
        3561,
        3565,
        3581,
        3585,
        3589,
        3597,
        3603,
        3605,
        3617,
        3621,
        3641,
        3649,
        3653,
        3655,
        3667,
        3671,
        3675,
        3685,
        3693,
        3695,
        3711,
        3713,
        3725,
        3729,
        3737,
        3743,
        3764,
        3766,
        3772,
        3776,
        3788,
        3792,
        3800,
        3804,
        3812,
        3824,
        3828,
        3830,
        3848,
        3852,
        3860,
        3864,
        3874,
        3876,
        3892,
        3900,
        3906,
        3910,
        3918,
        3920,
        3944,
        3946,
        3954,
        3960,
        3966,
        3972,
        3980,
        3982,
        3994,
        4002,
        4010,
        4014,
        4032,
        4034,
        4038,
        4046,
        4062,
        4064,
        4072,
        4074,
        4086,
        4094,
        4098,
        4102,
        4122,
        4127,
        4131,
        4139,
        4145,
        4149,
        4173,
        4175,
        4183,
        4187,
        4191,
        4195,
        4207,
        4213,
        4221,
        4227,
        4243,
        4245,
        4253,
        4255,
        4267,
        4275,
        4283,
        4285,
        4305,
        4309,
        4321,
        4329,
        4335,
        4337,
        4345,
        4349,
        4359,
        4365,
        4373,
        4375,
        4399,
        4401,
        4405,
        4413,
        4421,
        4429,
        4441,
        4445,
        4451,
        4455,
        4463,
        4467,
        4491,
        4493,
        4497,
        4509,
        4518,
        4520,
        4528,
        4532,
        4548,
        4552,
        4560,
        4562,
        4580,
        4584,
        4592,
        4596,
        4606,
        4610,
        4626,
        4628,
        4634,
        4646,
        4650,
        4654,
        4670,
        4674,
        4678,
        4682,
        4700,
        4702,
        4718,
        4722,
        4736,
        4744,
        4748,
        4752,
        4764,
        4766,
        4774,
        4780,
        4788,
        4792,
        4808,
        4816,
        4822,
        4826,
        4830,
        4832,
        4862,
        4866,
        4872,
        4876,
        4882,
        4888,
        4900,
        4902,
        4918,
        4925,
        4933,
        4937,
        4949,
        4951,
        4955,
        4967,
        4979,
        4983,
        4995,
        4997,
        5009,
        5017,
        5025,
        5027,
        5043,
        5047,
        5051,
        5057,
        5069,
        5073,
        5089,
        5091,
        5101,
        5105,
        5113,
        5117,
        5141,
        5143,
        5147,
        5155,
        5171,
        5173,
        5181,
        5185,
        5191,
        5203,
        5207,
        5211,
        5229,
        5231,
        5247,
        5251,
        5257,
        5259,
        5271,
        5277,
        5285,
        5293,
        5297,
        5301,
        5325,
        5329,
        5337,
        5345,
        5360,
        5364,
        5372,
        5374,
        5380,
        5384,
        5392,
        5396,
        5420,
        5424,
        5428,
        5436,
        5442,
        5444,
        5460,
        5464,
        5482,
        5488,
        5492,
        5496,
        5508,
        5516,
        5524,
        5528,
        5536,
        5538,
        5558,
        5560,
        5572,
        5576,
        5584,
        5588,
        5608,
        5612,
        5616,
        5628,
        5640,
        5642,
        5650,
        5652,
        5660,
        5672,
        5680,
        5682,
        5700,
        5702,
        5710,
        5714,
        5728,
        5734,
        5742,
        5746,
        5758,
        5766,
        5770,
        5772,
        5804,
        5807,
        5811,
        5815,
        5821,
        5827,
        5839,
        5845,
        5855,
        5859,
        5871,
        5875,
        5887,
        5889,
        5897,
        5909,
        5917,
        5919,
        5935,
        5937,
        5949,
        5957,
        5961,
        5963,
        5987,
        5991,
        5995,
        6001,
        6013,
        6017,
        6033,
        6037,
        6045,
        6051,
        6059,
        6067,
        6079,
        6081,
        6085,
        6089,
        6109,
        6111,
        6129,
        6131,
        6143,
        6151,
        6155,
        6157,
        6173,
        6177,
        6185,
        6195,
        6201,
        6205,
        6213,
        6217,
        6233,
        6241,
        6245,
        6249,
        6276,
        6280,
        6288,
        6296,
        6304,
        6308,
        6316,
        6318,
        6324,
        6330,
        6346,
        6348,
        6368,
        6372,
        6376,
        6384,
        6390,
        6394,
        6410,
        6412,
        6428,
        6432,
        6436,
        6440,
        6464,
        6470,
        6474,
        6480,
        6492,
        6494,
        6510,
        6516,
        6522,
        6526,
        6530,
        6538,
        6562,
        6564,
        6572,
        6576,
        6588,
        6590,
        6598,
        6602,
        6612,
        6628,
        6636,
        6638,
        6650,
        6654,
        6666,
        6670,
        6686,
        6688,
        6700,
        6704,
        6710,
        6718,
        6722,
        6726,
        6754,
        6757,
        6765,
        6771,
        6777,
        6781,
        6797,
        6799,
        6811,
        6819,
        6827,
        6829,
        6847,
        6851,
        6855,
        6867,
        6877,
        6879,
        6887,
        6891,
        6909,
        6915,
        6919,
        6921,
        6937,
        6941,
        6949,
        6957,
        6969,
        6973,
        6997,
        6999,
        7011,
        7015,
        7023,
        7027,
        7039,
        7041,
        7045,
        7053,
        7069,
    ]
    diff = set(res) - set(expected)
    assert len(diff) == 0


def test_upper_bound_a_n():
    zs = list(range(500))
    upper_bounds = [upper_bound_a_n(z) for z in zs]
    test = all(a_n(n - 1) <= z < a_n(n) for n, z in zip(upper_bounds, zs))
    assert test
